@page
@using TestEmployeeApp.Model
@model TestEmployeeApp.Pages.Peoples.PeopleModel
@{
    var alertMessage = TempData["AlertMessage"];
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
        <title>List Of People</title>

    </head>
    <body>
        <!-- Page content -->
        <div id="page-content-wrapper">
            <div class="page-content">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <div class="header-icon">
                        <i class="fa fa-address-book-o"></i>
                    </div>
                    <div class="header-title">
                        <h1> List Of People</h1>
                        <small></small>
                        <ul class="link hidden-xs">
                            <li><a asp-area="" asp-page="/Index"><i class="fa fa-home"></i>Home</a></li>
                            <li><a asp-area="" asp-page="/Peoples/People">People</a></li>
                        </ul>
                    </div>
                </section>
                <!-- page section -->
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="card">
                                <div class="card-content">
                                    <div class="row">
                                        <form class="col s12 m-t-20" method="post">
                                            <div class="input-field form-input col s4">
                                                <i class="material-icons prefix">account_circle</i>
                                                <input id="icon_prefix" type="text" class="validate">
                                                <label for="icon_prefix">Person Name</label>
                                            </div>
                                            <div class="input-field form-input col s4">
                                                <i class="material-icons prefix">account_circle</i>
                                                <input id="icon_prefix" type="number" class="validate">
                                                <label for="icon_prefix">Age</label>
                                            </div>

                                            <div class="input-field form-input col s4">
                                                <i class="material-icons prefix">textsms</i>
                                                <input id="icon_prefix" type="text" class="validate">
                                                <label for="icon_prefix">Description</label>
                                            </div>
                                            <div class="input-field form-input form-input-select col s6">
                                                <label>Country</label>
                                                <select class="icons">
                                                    <option value="" disabled selected>Select Country</option>
                                                    <option value="1">Option 1</option>
                                                    <option value="2">Option 2</option>
                                                    <option value="3">Option 3</option>
                                                </select>
                                            </div>
                                            <div class="input-field form-input form-input-select col s6">
                                                <label>State</label>
                                                <select class="icons">
                                                    <option value="" disabled selected>Select State</option>
                                                    <option value="1">Option 1</option>
                                                    <option value="2">Option 2</option>
                                                    <option value="3">Option 3</option>
                                                </select>
                                            </div>
                                            <div class="input-field form-input col s4">
                                                <a type="submit" class="waves-effect waves-light btn blue">Add Person</a>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-content">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    <th scope="col">Name </th>
                                                    <th scope="col">Age </th>
                                                    <th scope="col">Description</th>
                                                    <th scope="col">Country</th>
                                                    <th scope="col">State</th>
                                                    <th scope="col">Created On</th>
                                                    <th scope="col">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Naeem Khan</td>
                                                    <td>25</td>
                                                    <td>modified description</td>
                                                    <td>India</td>
                                                    <td>Orissa</td>
                                                    <td>2024-05-15 07:18:23 PM</td>
                                                    <td>
                                                        <button class="btn btn-sm" data-toggle="tooltip" data-placement="left" title="Update"><i class="fa fa-pencil" aria-hidden="true"></i></button>
                                                        <button id="modal2" class="btn btn-danger btn-sm"><i class="fa fa-trash-o" aria-hidden="true"></i></button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- ./row -->
                </div>
                <!-- ./cotainer -->
            </div>
            <!-- ./page-content -->
        </div>
        <!-- ./page-content-wrapper -->


        <script>
            // JavaScript to display the custom alert
            function displayCustomAlert() {
                document.getElementById("customAlert").style.display = "block";
            }
        </script>
        <script>
            // JavaScript function to handle editing an entry
            function editEntry(id) {
                console.log("Editing entry with ID: " + id);

                $.ajax({
                    url: webApi + "api/People/EditPeople/" + id,
                    method: "GET",
                    cache: false,
                    contentType: "application/json",
                    success: function (response) {
                        console.log("Success:", response);
                        if (response.status == 200) {
                            $('#id').val(response.response.id);
                            $('#name').val(response.response.name);
                            $('#age').val(response.response.age);
                            $('#description').val(response.response.description);
                            $('#countryId option:selected').val(response.response.countryId);
                            $('#stateId option:selected').val(response.response.stateId);
                        }
                    },
                    error: function (xhr, status, error) {
                        // Handle error here
                        console.error("Error:", xhr.responseText);
                    }
                });

            }

            function GetStateByCountry() {
                let selectedCountry = $('#countryId option:selected').val();
                debugger
                $.ajax({
                    url: webApi + "api/People/GetStateList/" + selectedCountry,
                    method: "GET",
                    cache: false,
                    contentType: "application/json",
                    success: function (response) {
                        console.log("Success:", response);
                        if (response.status == 200) {
                            $('#stateId').off();
                            $('#stateId').empty();
                            let innerStr = '<option value="0">Select State</option>';
                            for (let i = 0; i < response.response.length; i++) {
                                innerStr += '<option value="' + response.response[i].id + '">' + response.response[i].state + '</option>';
                            }
                            $('#stateId').html(innerStr);
                        }
                    },
                    error: function (xhr, status, error) {
                        // Handle error here
                        console.error("Error:", xhr.responseText);
                    }
                });
            }

            function deleteEntry(id) {
                console.log("Deleting entry with ID: " + id);

                if(confirm("Are you sure you want to delete this?"))
                {
                    $.ajax({
                        url: webApi + "api/People/DeletePeople/" + id,
                        method: "GET",
                        cache: false,
                        contentType: "application/json",
                        success: function (response) {
                            console.log("Success:", response);
                            if (response.status == 200) {
                                alert(response.message);
                                window.location.reload();
                            }
                        },
                        error: function (xhr, status, error) {
                            // Handle error here
                            console.error("Error:", xhr.responseText);
                        }
                    });
                }
            }


            function main() {
                var $body = $('body');
                $('#modal2').click(function () {
                    ssi_modal.confirm({
                        content: 'Are you sure you want to exit?',
                        okBtn: {
                            className: 'btn btn-primary'
                        },
                        cancelBtn: {
                            className: 'btn btn-danger'
                        }
                    }, function (result) {
                        if (result)
                            ssi_modal.notify('success', {
                                content: 'Result: ' + result
                            });
                        else
                            ssi_modal.notify('error', {
                                content: 'Result: ' + result
                            });
                    });
                });
            }

            main();
        </script>
    </body>

    </html>



}
